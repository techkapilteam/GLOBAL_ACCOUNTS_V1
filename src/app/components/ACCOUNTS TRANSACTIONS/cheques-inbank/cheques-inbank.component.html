<div class="screen-container">
  <div class="screen-card">
    <div class="screen-header">
      <h2>Cheques In Bank</h2>
    </div>

    <div class="screen-content">
      <form>
        <div class="row mb-3">
          <div class="col-md-2">
            <label>Transaction Date</label>
            <input type="text" class="form-control" bsDatepicker [(ngModel)]="transactionDate" name="transactionDate"
                   [bsConfig]="dpConfig" onkeydown="return false">
          </div>

          <div class="col-md-2">
            <label>Cheque Clear Date</label>
            <input type="text" class="form-control" bsDatepicker [(ngModel)]="chequesclearDate" name="chequesclearDate"
                   [bsConfig]="dpConfig" onkeydown="return false">
          </div>

          <div class="col-md-3">
            <label>Bank</label>
            <select class="form-select" [(ngModel)]="selectedBank" name="bank">
              <option value="">Select</option>
              <option value="SBI">SBI</option>
              <option value="HDFC">HDFC</option>
              <option value="ICICI">ICICI</option>
              <option value="IDBI">IDBI</option>
            </select>
          </div>

          <div class="col-md-5">
            <div class="border rounded shadow-sm bg-light p-3">
              <h4 style="color:#26408A;"><u>Cheques in Bank</u></h4>
              <div class="d-flex align-items-center mt-2">
                <label>Balance :</label>
                <label class="sec-head-bold ml-2">15,74,948Dr</label>
                &nbsp;&nbsp;&nbsp;
                <label class="ml-4"> Date: {{ formatDate(transactionDate) }}</label>
              </div>
            </div>
          </div>
        </div>

        <div class="row mb-3" *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'">
          <div class="col-md-4">
            <input class="form-control" placeholder="Search" [(ngModel)]="searchText" name="search">
          </div>
          <div class="col-md-2">
            <button type="button" class="btn btn-primary" (click)="showCheques()">Show</button>
          </div>
        </div>

        <div class="mb-3">
          <nav>
            <div class="nav nav-tabs">
              <button class="nav-link" (click)="filterTab('All')">All</button>
              <button class="nav-link" (click)="filterTab('Received')">Cheques Deposited</button>
              <button class="nav-link" (click)="filterTab('Online')">Online Receipts</button>
              <button class="nav-link" (click)="filterTab('Deposited')">Cleared</button>
              <button class="nav-link" (click)="filterTab('Cancelled')">Returned</button>
            </div>
          </nav>
        </div>

        <div class="row mb-3" *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'">
          <div class="col-md-3">
            <label>BRS From Date</label>
            <input type="text" class="form-control" bsDatepicker [(ngModel)]="brsFromDate" name="brsFromDate"
                   [bsConfig]="dpConfig" onkeydown="return false">
          </div>
          <div class="col-md-3">
            <label>BRS To Date</label>
            <input type="text" class="form-control" bsDatepicker [(ngModel)]="brsToDate" name="brsToDate"
                   [bsConfig]="dpConfig" onkeydown="return false">
          </div>
          <div class="col-md-2 align-self-end">
            <button type="button" class="btn btn-primary" (click)="showClearedCheques()">Show</button>
          </div>
        </div>

        <div class="table-responsive" style="overflow-x:auto;">
          <ngx-datatable *ngIf="showTable" class="bootstrap mt-2" [rows]="filteredCheques" [headerHeight]="50"
            [rowHeight]="'auto'" [columnMode]="'standard'" [scrollbarH]="true">
            
            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Checkbook" sortable="false"
              prop="checkbook" [width]="60">
              <ng-template ngx-datatable-header-template>
                <input type="checkbox" class="form-check-input" [(ngModel)]="headerCheckbook"
                  (change)="toggleAllCheckbook($event)">
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Clear" sortable="false"
              prop="clear" [width]="80"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Return" sortable="false"
              prop="return" [width]="80"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Reference No" sortable="false"
              prop="referenceNo" [width]="120"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" sortable="false"
              name="Cheque/Reference No." prop="chequeNo" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Branch Name" sortable="false"
              prop="branchName" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Amount" sortable="false"
              prop="amount" [width]="100"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Party" sortable="false"
              prop="party" [width]="120"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab !== 'Deposited' && activeTab !== 'Cancelled'" name="Receipts" sortable="false"
              prop="receipts" [width]="100"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'"
              name="Cheque/Reference No." sortable="false" prop="chequeNo" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Branch Name" sortable="false"
              prop="branchName" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Amount" sortable="false"
              prop="amount" [width]="100"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Party" sortable="false"
              prop="party" [width]="120"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="ReceiptDate" sortable="false"
              prop="receipts" [width]="100">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ formatDate(row.date) }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Deposited Date" sortable="false"
              prop="depositedDate" [width]="120">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ formatDate(row.depositedDate) }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Cleared Date" sortable="false"
              prop="clearedDate" [width]="120">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ formatDate(row.clearedDate) }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Receipt Id" sortable="false"
              prop="receiptId" [width]="120"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Transaction Mode" sortable="false"
              prop="transactionMode" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Cheque Bank Name" sortable="false"
              prop="chequeBankName" [width]="150"></ngx-datatable-column>

            <ngx-datatable-column *ngIf="activeTab === 'Deposited' || activeTab === 'Cancelled'" name="Cheque Branch Name" sortable="false"
              prop="chequeBranchName" [width]="150"></ngx-datatable-column>

          </ngx-datatable>
        </div>

        <div *ngIf="showTable" class="d-flex justify-content-end mt-2 gap-2">
          <button type="button" class="btn btn-secondary" (click)="clearSelections()">Clear</button>
          <button type="button" class="btn btn-primary" (click)="saveSelections()">Save</button>
        </div>

      </form>
    </div>
  </div>
</div>
