<div class="screen-container">
  <div class="screen-card">
    <div class="screen-header">
      <h2>Cheque Enquiry</h2>
    </div>

    <div class="screen-content">
      <form [formGroup]="ChequesIssuedForm" class="container py-3">

        <div class="row mb-3">
          <div class="col-12">
            <label class="bc-2">Select Cheques Type</label>
          </div>

          <div class="col-12 d-flex gap-4">
            <div class="form-check radio-btn-secondary">
              <input class="form-check-input" type="radio" name="pchequestype" formControlName="pchequestype"
                value="Issued" (change)="selectChequesType('Issued')" />
              <label class="mt-1">Issued</label>
            </div>

            <div class="form-check radio-btn-secondary">
              <input class="form-check-input" type="radio" name="pchequestype" formControlName="pchequestype"
                value="Received" (change)="selectChequesType('Received')" />
              <label class="mt-1">Received</label>
            </div>
          </div>
        </div>

        <div *ngIf="showOrHideIssuedCheques" class="mt-3">

          <div class="row mb-3">
            <div class="col-md-6">
              <input type="search" class="form-control" placeholder="Search by Cheque / Reference No (min 3 chars)"
                (input)="onSearchForCheque($event.target.value)" />
            </div>

            <div class="col-md-6">
              <div *ngIf="spinner" class="spinner-border text-muted"></div>
            </div>
          </div>

          <ul class="nav nav-tabs mt-3">
            <li class="nav-item">
              <a class="nav-link active">
                Cheques
                <span class="badge bg-danger ms-2">
                  {{ displayAllChequesDataBasedOnForm.length }}
                </span>
              </a>
            </li>
          </ul>

          <p-table [value]="displayAllChequesDataBasedOnForm" [paginator]="true" [rows]="pageCriteria.pageSize"
            [first]="pageCriteria.offset * pageCriteria.pageSize" [totalRecords]="pageCriteria.totalrows"
            [scrollable]="true" scrollHeight="500px" responsiveLayout="scroll" styleClass="p-datatable-gridlines mt-3">

            <ng-template pTemplate="header">
              <tr>
                <th class="text-center">Cheque Status</th>
                <th class="text-center">Cheque / Reference No</th>
                <th class="text-end">Amount</th>
                <th class="text-center">Payment Id</th>
                <th class="text-center">Payment Date</th>
                <th class="text-center">Cleared Date</th>
                <th class="text-center">Returned Date</th>
                <th class="text-center">Cancelled Date</th>
                <th class="text-center">Transaction Mode</th>
                <th class="text-start">Party</th>
                <th class="text-start">Account No</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
              <tr>
                <td class="text-center">{{ row.chequeStatus }}</td>

                <td class="text-center">{{ row.pChequenumber }}</td>

                <td class="text-end">
                  {{ currencySymbol }} {{ row.ptotalreceivedamount | number:'1.2-2' }}
                </td>

                <td class="text-center">{{ row.preceiptid }}</td>

                <td class="text-center">
                  {{ row.preceiptdate | date:'dd-MM-yyyy' }}
                </td>

                <td class="text-center">
                  <span *ngIf="row.ptypeofpayment === 'CHEQUE' && row.pchequestatus === 'P'">
                    {{ row.pdepositeddate | date:'dd-MM-yyyy' }}
                  </span>
                </td>

                <td class="text-center">
                  <span *ngIf="row.pchequestatus === 'R'">
                    {{ row.pCleardate | date:'dd-MM-yyyy' }}
                  </span>
                </td>

                <td class="text-center">
                  <span *ngIf="row.pchequestatus === 'C'">
                    {{ row.pCleardate | date:'dd-MM-yyyy' }}
                  </span>
                </td>

                <td class="text-center">{{ row.ptypeofpayment }}</td>

                <td class="text-start">
                  {{ row.ppartyname || '--NA--' }}
                </td>

                <td class="text-start">
                  {{ row.pAccountnumber || '--NA--' }}
                </td>
              </tr>
            </ng-template>

            <ng-template pTemplate="footer">
              <tr>
                <td colspan="2" class="text-end fw-bold">Total</td>
                <td class="text-end fw-bold">
                  {{ currencySymbol }} {{ totalamount | number:'1.2-2' }}
                </td>
                <td colspan="8"></td>
              </tr>

              <tr *ngIf="pageCriteria.totalrows > 0">
                <td colspan="11">
                  Page {{ pageCriteria.CurrentPage }} of {{ pageCriteria.TotalPages }}
                  ({{ pageCriteria.totalrows }} items)
                </td>
              </tr>
            </ng-template>

          </p-table>
        </div>

        <div *ngIf="showOrHideReceivedCheques" class="mt-3">

          <div class="row mb-3 align-items-center">
            <div class="col-md-6">
              <input type="search" class="form-control" placeholder="Search by Cheque / Reference No (min 3 chars)"
                (input)="onSearchForChequeReceived($event.target.value)" />
            </div>

            <div class="col-md-6 text-end d-flex justify-content-end gap-3">
              <button class="btn btn-outline-danger me-2" (click)="pdfOrprint('Pdf')">
                <i class="fa fa-file-pdf me-1"></i> PDF
              </button>

              <button class="btn btn-outline-secondary me-2" (click)="pdfOrprint('Print')">
                <i class="fa fa-print me-1"></i> Print
              </button>
            </div>
          </div>

          <p-table [value]="displayGridDataBasedOnForm" [paginator]="true" [rows]="pageCriteria.pageSize"
            [first]="pageCriteria.offset * pageCriteria.pageSize" [totalRecords]="pageCriteria.totalrows"
            responsiveLayout="scroll" styleClass="p-datatable-gridlines mt-3">

            <ng-template pTemplate="header">
              <tr>
                <th>Cheque Status</th>
                <th>Cheque / Reference No</th>
                <th>Branch</th>
                <th>Amount</th>
                <th>Receipt Id</th>
                <th>Receipt Date</th>
                <th>Deposited Date</th>
                <th>Cleared Date</th>
                <th>Returned Date</th>
                <th>Transaction Mode</th>
                <th>Cheque Bank Name</th>
                <th>Party</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
              <tr>
                <td>{{ row.chequeStatus }}</td>

                <td>{{ row.pChequenumber }}</td>

                <td>{{ row.pbranchname }}</td>

                <td>
                  {{ currencySymbol }} {{ row.ptotalreceivedamount | number:'1.2-2' }}
                </td>

                <td>{{ row.preceiptid }}</td>

                <td>{{ row.preceiptdate | date:'dd-MM-yyyy' }}</td>

                <td>{{ row.pdepositeddate | date:'dd-MM-yyyy' }}</td>

                <td>{{ row.pCleardate | date:'dd-MM-yyyy' }}</td>

                <td>
                  {{ row.pchequestatus === 'R' ? (row.pCleardate | date:'dd-MM-yyyy') : '' }}
                </td>

                <td>{{ row.ptypeofpayment }}</td>

                <td>{{ row.pbankname }}</td>

                <td>{{ row.ppartyname }}</td>
              </tr>
            </ng-template>

          </p-table>
        </div>

        <div class="d-flex justify-content-end mt-4">
          <button type="button" class="btn btn-danger" (click)="Clear()">
            Clear
          </button>
        </div>

      </form>
    </div>
  </div>
</div>