<div class="screen-container">
  <div class="screen-card">
    <div class="screen-header">
      <h2>Cheque Enquiry</h2>
    </div>

    <div class="screen-content">
      <form [formGroup]="ChequesIssuedForm" class="container py-3">

        <div class="row mb-3">
          <div class="col-12">
            <label class="bc-2">Select Cheques Type</label>
          </div>

          <div class="col-12 d-flex gap-4">
            <div class="form-check radio-btn-secondary">
              <input class="form-check-input" type="radio" name="pchequestype" formControlName="pchequestype"
                value="Issued" (change)="selectChequesType('Issued')" />
              <label class="mt-1">Issued</label>
            </div>

            <div class="form-check radio-btn-secondary">
              <input class="form-check-input" type="radio" name="pchequestype" formControlName="pchequestype"
                value="Received" (change)="selectChequesType('Received')" />
              <label class="mt-1">Received</label>
            </div>
          </div>
        </div>

        <div *ngIf="showOrHideIssuedCheques" class="mt-3">

          <div class="row mb-3">
            <div class="col-md-6">
              <input type="search" class="form-control" placeholder="Search by Cheque / Reference No (min 3 chars)"
                (input)="onSearchForCheque($event.target.value)" />
            </div>

            <div class="col-md-6">
              <div *ngIf="spinner" class="spinner-border text-muted"></div>
            </div>
          </div>

          <ul class="nav nav-tabs mt-3">
            <li class="nav-item">
              <a class="nav-link active">
                Cheques
                <span class="badge bg-danger ms-2">
                  {{ displayAllChequesDataBasedOnForm.length }}
                </span>
              </a>
            </li>
          </ul>

          <ngx-datatable class="material table mt-3" [rows]="displayAllChequesDataBasedOnForm" columnMode="force"
            [headerHeight]="50" [rowHeight]="'auto'" [limit]="pageCriteria.pageSize" [offset]="pageCriteria.offset"
            [footerHeight]="pageCriteria.footerPageHeight" [scrollbarH]="true" [summaryRow]="true" [summaryHeight]="50">

            <ngx-datatable-column name="Cheque Status" prop="chequeStatus" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
            </ngx-datatable-column>

            <ngx-datatable-column name="Cheque / Reference No" prop="pChequenumber" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
            </ngx-datatable-column>

            <ngx-datatable-column name="Amount" prop="ptotalreceivedamount" sortable="false" [cellClass]="'text-end'"
              [headerClass]="'text-end'">

              <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                {{ currencySymbol }} {{ row.ptotalreceivedamount | number:'1.2-2' }}
              </ng-template>

              <ng-template ngx-datatable-summary-template>
                {{ currencySymbol }} {{ totalamount | number:'1.2-2' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Payment Id" prop="preceiptid" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
            </ngx-datatable-column>

            <ngx-datatable-column name="Payment Date" prop="preceiptdate" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
            </ngx-datatable-column>

            <ngx-datatable-column name="Cleared Date" prop="pdepositeddate" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
              <ng-template ngx-datatable-cell-template let-row="row">
                <span *ngIf="row.ptypeofpayment === 'CHEQUE' && row.pchequestatus === 'P'">
                  {{ row.pdepositeddate | date:'dd-MM-yyyy' }}
                </span>
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Returned Date" prop="pCleardate" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
              <ng-template ngx-datatable-cell-template let-row="row">
                <span *ngIf="row.pchequestatus === 'R'">
                  {{ row.pCleardate | date:'dd-MM-yyyy' }}
                </span>
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Cancelled Date" prop="pCleardate" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
              <ng-template ngx-datatable-cell-template let-row="row">
                <span *ngIf="row.pchequestatus === 'C'">
                  {{ row.pCleardate | date:'dd-MM-yyyy' }}
                </span>
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Transaction Mode" prop="ptypeofpayment" sortable="false" [cellClass]="'text-center'"
              [headerClass]="'text-center'">
            </ngx-datatable-column>

            <ngx-datatable-column name="Party" prop="ppartyname" sortable="false" [cellClass]="'text-start'"
              [headerClass]="'text-start'">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.ppartyname || '--NA--' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Account No" prop="pAccountnumber" sortable="false" [cellClass]="'text-start'"
              [headerClass]="'text-start'">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.pAccountnumber || '--NA--' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-footer>
              <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="pageSize"
                let-curPage="curPage">

                <div *ngIf="rowCount > 0">
                  Page {{ pageCriteria.CurrentPage }} of {{ pageCriteria.TotalPages }}
                  ({{ pageCriteria.totalrows }} items)
                </div>

                <!-- <datatable-pager
            [page]="curPage"
            [size]="pageSize"
            [count]="rowCount"
            (change)="onFooterPageChange($event)">
          </datatable-pager> -->
              </ng-template>
            </ngx-datatable-footer>

          </ngx-datatable>
        </div>

        <div *ngIf="showOrHideReceivedCheques" class="mt-3">

          <div class="row mb-3 align-items-center">
            <div class="col-md-6">
              <input type="search" class="form-control" placeholder="Search by Cheque / Reference No (min 3 chars)"
                (input)="onSearchForChequeReceived($event.target.value)" />
            </div>

            <div class="col-md-6 text-end d-flex justify-content-end gap-3">
              <img src="images/pdf-icon-blue.svg" width="18" (click)="pdfOrprint('Pdf')" />
              <img src="images/print-icon-blue.svg" width="18" (click)="pdfOrprint('Print')" />
            </div>
          </div>

          <ngx-datatable class="material table mt-3" [rows]="displayGridDataBasedOnForm" columnMode="force"
            [headerHeight]="50" [rowHeight]="'auto'" [limit]="pageCriteria.pageSize" [offset]="pageCriteria.offset"
            [footerHeight]="pageCriteria.footerPageHeight">

            <ngx-datatable-column name="Cheque Status" prop="chequeStatus" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Cheque / Reference No" prop="pChequenumber" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Branch" prop="pbranchname" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Amount" prop="ptotalreceivedamount" sortable="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ currencySymbol }} {{ row.ptotalreceivedamount | number:'1.2-2' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Receipt Id" prop="preceiptid" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Receipt Date" prop="preceiptdate" sortable="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.preceiptdate | date:'dd-MM-yyyy' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Deposited Date" prop="pdepositeddate" sortable="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.pdepositeddate | date:'dd-MM-yyyy' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Cleared Date" prop="pCleardate" sortable="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.pCleardate | date:'dd-MM-yyyy' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Returned Date" prop="pCleardate" sortable="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                {{ row.pchequestatus === 'R' ? (row.pCleardate | date:'dd-MM-yyyy') : '' }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Transaction Mode" prop="ptypeofpayment" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Cheque Bank Name" prop="pbankname" sortable="false"></ngx-datatable-column>

            <ngx-datatable-column name="Party" prop="ppartyname" sortable="false"></ngx-datatable-column>

          </ngx-datatable>
        </div>

        <div class="d-flex justify-content-end mt-4">
          <button type="button" class="btn btn-danger" (click)="Clear()">
            Clear
          </button>
        </div>

      </form>
    </div>
  </div>
</div>