<div class="screen-container">
  <div class="screen-card">
    <div class="screen-header">
      <h2>Issued Cheque</h2>
    </div>

    <div class="screen-content">
      <form [formGroup]="FrmIssuedCheque" autocomplete="off">

        <div class="row g-3">

          <div class="col-md-6">
            <label class="form-label required-field">Bank Name</label>

            <ng-select [items]="BankData" formControlName="pbankname" bindLabel="bankName" bindValue="bankAccountId"
              placeholder="Select" [searchable]="true" [clearable]="true" dropdownPosition="bottom"
              [clearOnBackspace]="true" appendTo="body" (change)="BankName_Cahange($event)"
              [ngClass]="{ 'is-invalid': f['pbankname'].touched && f['pbankname'].invalid }">
            </ng-select>

            <div class="invalid-feedback d-block" *ngIf="f['pbankname'].touched && f['pbankname'].errors?.['required']">
              Bank Name is required
            </div>
          </div>

          <div class="col-md-4">
            <label class="form-label required-field">Cheque No.</label>

            <ng-select [items]="lstBankChequeDetails" formControlName="pchqfromto" bindLabel="pchqfromto"
              bindValue="pchkBookId" placeholder="Select" appendTo="body" [searchable]="true" [clearable]="true"
              dropdownPosition="bottom" [clearOnBackspace]="true" (change)="GetIssuedBankDetails($event)"
              [ngClass]="{ 'is-invalid': f['pchqfromto'].touched && f['pchqfromto'].invalid }">
            </ng-select>

            <div class="invalid-feedback d-block"
              *ngIf="f['pchqfromto'].touched && f['pchqfromto'].errors?.['required']">
              Cheque Number is required
            </div>
          </div>

        </div>

      </form>
    </div>
  </div>

  <div class="card shadow-sm mt-4">
    <div class="card-header bg-light">
      <h6 class="mb-0">Unused Cheques</h6>
    </div>

    <div class="card-body p-0">

      <p-table [value]="gridData" [paginator]="true" [rows]="pageCriteria.pageSize"
        [first]="pageCriteria.offset * pageCriteria.pageSize" [totalRecords]="pageCriteria.totalrows"
        [rowsPerPageOptions]="[10,20,50,100]" responsiveLayout="scroll" styleClass="p-datatable-gridlines">

        <ng-template pTemplate="header">
          <tr>
            <th class="text-center">Cancel</th>
            <th>Cheque No.</th>
            <th>Bank Name</th>
            <th>Cheque Book ID</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-row>
          <tr>
            <td class="text-center">
              <input type="checkbox" [checked]="row.pchequestatus === true" (change)="checkedCancel($event, row)" />
            </td>
            <td>{{ row.pchequenumber }}</td>
            <td>{{ row.pbankname }}</td>
            <td>{{ row.pchkBookId }}</td>
          </tr>
        </ng-template>

        <ng-template pTemplate="footer" *ngIf="gridData?.length">
          <tr>
            <td colspan="4">
              <div class="px-3 py-2">
                Page {{ pageCriteria.pageNumber }} of {{ TotalPages }}
                ({{ pageCriteria.totalrows }} items)
              </div>
            </td>
          </tr>
        </ng-template>

      </p-table>
    </div>

    <div class="card-footer text-end">
      <button class="btn btn-primary px-4" type="button" (click)="UnusedChequeCancel()">
        {{ savebutton }}
      </button>
    </div>

  </div>

  <div class="card shadow-sm mt-4">

    <div class="card-body">

      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-outline-danger me-2" (click)="pdfOrprint('Pdf')">
          <i class="fa fa-file-pdf me-1"></i> PDF
        </button>

        <button class="btn btn-outline-success" (click)="export()">
          <i class="fa fa-file-excel me-1"></i> Excel
        </button>

        <button class="btn btn-outline-secondary me-2" (click)="pdfOrprint('Print')">
          <i class="fa fa-print me-1"></i> Print
        </button>
      </div>
      <div class="text-center mb-1 fw-bold fs-5">
        KAPIL CHITS (HYDERABAD) PVT. LTD.
      </div>

      <div class="text-center mb-1">
        Above TVS Showroom, 1st Floor, Opp: R&B Guest House, Old N.K-07, Kamarreddy
      </div>

      <div class="text-center mb-2 fw-semibold">
        CIN: U65992TG2008PTC060803
      </div>

      <hr class="mt-2 mb-3">

      <div id="print-section" class="border rounded p-3 bg-white shadow-sm">

        <h5 class="text-center mt-2">Issued Cheque Details</h5>

        <p-table [value]="gridDataDetails" [paginator]="true" [rows]="commencementgridPage.size || 0"
          [first]="(commencementgridPage.pageNumber || 0) * (commencementgridPage.size || 0)"
          [totalRecords]="commencementgridPage.totalElements || 0" [scrollable]="true" scrollHeight="400px"
          rowGroupMode="subheader" groupRowsBy="pchequestatus" sortField="pchequestatus"
          [sortOrder]="1" styleClass="p-datatable-gridlines mt-3">

          <ng-template pTemplate="header">
            <tr>
              <th>Cheque No.</th>
              <th>Payment ID</th>
              <th>Particulars</th>
              <th>Payment Date</th>
              <th>Cleared Date</th>
              <th class="text-end">Paid Amt.</th>
              <th>Bank Name</th>
              <th>Cheque Book ID</th>
              <th>Cheque Status</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="groupheader" let-rowData let-expanded="expanded">
            <tr>
              <td colspan="9">
                <span class="fw-bold">
                  <i class="pi" [ngClass]="expanded ? 'pi-chevron-down' : 'pi-chevron-right'">
                  </i>
                  {{ rowData.pchequestatus }}
                </span>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-row>
            <tr>
              <td>{{ row.pchequenumber }}</td>
              <td>{{ row.ppaymentid }}</td>
              <td>{{ row.pparticulars }}</td>
              <td>{{ row.ppaymentdate | date:'dd-MM-yyyy' }}</td>
              <td>{{ row.pcleardate | date:'dd-MM-yyyy' }}</td>
              <td class="text-end">
                <span *ngIf="row.ppaidamount !== 0">
                  {{ currencysymbol }} {{ row.ppaidamount | number:'1.2-2' }}
                </span>
              </td>
              <td>{{ row.pbankname }}</td>
              <td>{{ row.pchkBookId }}</td>
              <td>{{ row.pstatus }}</td>
            </tr>
          </ng-template>

        </p-table>
      </div>

    </div>
  </div>
</div>