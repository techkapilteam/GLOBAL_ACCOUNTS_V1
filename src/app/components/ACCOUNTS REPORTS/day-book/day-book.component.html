<div class="my-container">
    <ng-template #customLoadingTemplate>
        <div class="custom-class">

        </div>
    </ng-template>
    <!-- <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }" [template]="customLoadingTemplate">
    </ngx-loading> -->

</div>
<div class="section-content">
    <form [formGroup]="Daybook">
        <div class="row">
            <div class="col-md-12 col-xl-12">
                <!-- <p class="bc-2">Day Book</p> -->
                 <div class="screen-header">
                    <h2>Day Book</h2>
                </div><br/>
            </div>
            <div class="col-xl-2 col-md-2 mt-4">
                <div class="form-check form-check-inline check-btn-secondary">
                    <input class="form-check-input" id="asdate" type="checkbox" formControlName="date" (change)="checkox($event)">
                    <label class="mt-2" for="asdate"> Date :</label>
                </div>
            </div>

            <div class="col-xl-2 col-md-2 form-group ">
                <label>From Date</label>
                <input type="text" class="form-control" id="fromdate" readonly [bsConfig]="dpConfig" formControlName="dfromdate" (ngModelChange)="checkingfrommdate()" bsDatepicker #dp="bsDatepicker">

            </div>
            <div class=" col-xl-2 col-md-2 form-group">
                <div *ngIf="datepicker">
                    <label>To Date</label>
                    <input type="text" class="form-control" id="todate" readonly [bsConfig]="dppConfig" formControlName="dtodate" (ngModelChange)="checkdatevalidation()" bsDatepicker #dp="bsDatepicker">

                    <div *ngIf="validation" class="text-danger">
                        please select a valid date
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-md-3 form-group mt-2 pt-3">
                <!-- <label></label>
              <button aria-controls="hot" aria-selected="false" class="btn btn-b-icon  border-0"
                class="btn btn-b-icon  border-0" data-toggle="tab" (click)="getdaybookdata()" role="tab">
  
                <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading}"></i>
                <span *ngIf="!isLoading"><img class="mr-3" height="20px" src="assets/images/reports-white.svg"
                    width="20px"></span> {{savebutton}}
              </button> -->

              
                <!-- <button class="btn btn-s-icon px-3 border-0" (click)="getdaybookdata()">
                    <img src="assets/images/icon-check-white.svg" class="mr-3" width="20px" height="20px"  *ngIf="!disablesavebutton">
                    <i class="fa" [ngClass]="{'fa-spin fa-spinner': disablesavebutton}"></i> {{savebutton}}
                </button> -->

                 <button class="btn btn-primary px-3 border-0" (click)="getdaybookdata()">
                    <i class="fa"></i> {{isLoading ? 'Processing':'Generate Report'}}
                </button>


            </div>
            <div class="col-xl-3 col-md-3 form-group mt-2 pt-3">

                <!-- <button class="btn btn-s-icon px-3 border-0" (click)="GetChequeonHandDetails()">
                    <img src="assets/images/icon-check-white.svg" class="mr-3" width="20px" height="20px">
                    <i class="fa" ></i>Cheques On Hand
                </button> -->
                  <button class="btn btn-primary px-3 border-0" (click)="GetChequeonHandDetails()">
                    <i class="fa"></i> {{isLoading ? 'Processing':'Cheques On Hand'}}
                </button>

            </div>
        </div>
        <div class="row">
            <div class="col-xl-2 col-md-2 mt-4">
                <div class="form-check form-check-inline check-btn-secondary">
                    <input class="form-check-input" id="kgms" type="checkbox" (change)="checkboxx($event)">
                    <label class="mt-2" for="kgms"> kgms :</label>
                </div>
            </div>
            <div class="col-xl-4 col-md-4">
                <div *ngIf="kgms">
                    <label>Branch:</label>
                   <ng-select id="kgmsbranchschema" [items]="kgmsBranchList" title="Branch" formControlName="branch_code" bindLabel="branch_name" bindValue="branch_code" [multiple]="false" placeholder="Select" [searchable]="true" dropdownPosition="bottom" (change)="branch_change($event)"></ng-select>


                </div>
            </div>
            <div class="col-xl-3 col-md-3 form-group mt-2 pt-3">
                <!-- <button class="btn btn-s-icon px-3 border-0" (click)="getsummaryReport()" [disabled]="chkbox2">
                    {{generateReport}}
                </button> -->
                <button class="btn btn-primary px-3 border-0" (click)="getsummaryReport()">
                    <i class="fa"></i> {{isLoading ? 'Processing':'Generate Report'}}
                </button>
            </div>
        </div>
    </form>
</div>


<div id="template" class="section-content mt-2">
    <div class="d-flex justify-content-end mr-3 mt-4" *ngIf="showicons">
        <ul class="temp-ul">
            <li class="temp-ico ml-2">
                <img src="assets/images/pdf-icon-blue.svg " width="18px" class="pt-2" title="pdf" style="cursor: pointer;" (click)="pdfOrprint('Pdf')" />
            </li>
            <li class="temp-ico ml-2">
                <img src="assets/images/print-icon-blue.svg " width="18px" class="pt-2" title="print" style="cursor: pointer;" (click)="pdfOrprint('Print')" />
            </li>
        </ul>
    </div>



    <div id="temp-box">
        <div class="mt-2 border rounded shadow-sm bg-white">
            <div class="row">
                <div class="col-md-12">
                    <!-- <app-company-details [PrintedDateShowhide]="printedDate"></app-company-details> -->

                    <div class="report-head">
                        <p class="font-16 text-dark text-center m-0">
                            Day Book
                        </p>

                    </div>
                    

                </div>
            </div>
        </div>
        <div class="section-card">
            <div class="row">

                <div class="col-md-6">
                    <label class="print-font" style="font-weight: bold !important;">
                        {{showdate}}:
                        {{betweenfromdate|dateformat}} {{betweendates}} {{betweentodate |dateformat}}
                    </label>
                </div>
            </div>

            <table class="table mt-2" style="width:100%">
                <thead>
                    <tr>
                        <th class="text-center border-bot" colspan="3">Receipts</th>
                        <th class="text-center" colspan="6">Payments</th>
                    </tr>
                </thead>
            </table>
            <ngx-datatable #myTable class='material expandable table' [rows]='gridData' [headerHeight]="50" [rowHeight]="50" [columnMode]="'force'" [scrollbarH]="true" [groupRowsBy]="'prcpttransactiondate'" [groupExpansionDefault]="true">

                <ngx-datatable-group-header [rowHeight]="50" #myGroupHeader (toggle)="onDetailToggle($event)">
                    <ng-template let-group="group" let-expanded="expanded" ngx-datatable-group-header-template>
                        <div style="padding-left:5px;">
                            <a [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded" title="Expand/Collapse Group" (click)="toggleExpandGroup(group)">
                                <b>{{ group.value[0].prcpttransactiondate|dateformat }} </b>
                            </a>

                        </div>
                    </ng-template>
                </ngx-datatable-group-header>
                <ngx-datatable-column prop="prcpttransactionno" name="Transaction No."></ngx-datatable-column>
                <!-- <ngx-datatable-column [hidden]="hidedate" prop="prcpttransactiondate" name="Date">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                <div>
                                    <span titlte="{{row.prcpttransactiondate | dateformat}}">{{row.prcpttransactiondate | dateformat}}</span>
                                </div>
                            </ng-template>
                        </ngx-datatable-column> -->

                <ngx-datatable-column prop="prcptparticulars" name="Particulars"></ngx-datatable-column>

                <ngx-datatable-column prop="prcptaccountname" name="Type"></ngx-datatable-column>
                <ngx-datatable-column prop="prcptdebitamount" name="Amount" [headerClass]="'header-right'" [cellClass]="'cell-right'">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.prcptdebitamount == 0"></div>
                        <div *ngIf="row.prcptdebitamount !== 0">
                            {{currencysymbol}} {{row.prcptdebitamount.toFixed(2) | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="ptransactionno" name="Transaction No." class="border-left p-4">
                </ngx-datatable-column>
                <ngx-datatable-column prop="pparticulars" name="Particulars"></ngx-datatable-column>
                <ngx-datatable-column prop="paccountname" name="Type"></ngx-datatable-column>
                <ngx-datatable-column prop="pcreditamount" name="Amount" [headerClass]="'header-right'" [cellClass]="'cell-right'">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.pcreditamount == 0"></div>
                        <div *ngIf="row.pcreditamount !== 0">
                            {{currencysymbol}} {{row.pcreditamount.toFixed(2) | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
                <!--  <ngx-datatable-footer *ngIf="gridData">
                    <ng-template ngx-datatable-footer-template let-rowCount="rowCount"
                        let-pageSize="pageCriteria.pageSize" let-selectedCount="selectedCount" let-curPage="curPage"
                        let-offset="pageCriteria.offset" let-isVisible="isVisible">
                        <div style="padding: 5px 10px" *ngIf="gridData.length>0">
                           <div>{{ pageCriteria.currentPageRows }} {{pageCriteria.footerMessagetext1}}
                                {{ pageCriteria.totalrows }} {{pageCriteria.footerMessagetext2}}</div>
                        </div>
                        <datatable-pager [pagerLeftArrowIcon]="'datatable-icon-left'"
                            [pagerRightArrowIcon]="'datatable-icon-right'" [pagerPreviousIcon]="'datatable-icon-prev'"
                            [pagerNextIcon]="'datatable-icon-skip'" [page]="curPage" [size]="pageCriteria.pageSize"
                            [count]="rowCount" (change)="onFooterPageChange($event)">
                        </datatable-pager>
                    </ng-template>
                </ngx-datatable-footer> -->
            </ngx-datatable>




            <div class="row" *ngIf="hideRow">
                <div class="col-md-6 text-right font-weight-bold text-danger mt-2">
                    Received Amount : {{currencysymbol}} {{Receiptsamount.toFixed(2) |currencypipe}}
                </div>
                <div class="col-md-6 text-right font-weight-bold text-danger  mt-2">
                    Paid Amount :{{currencysymbol}} {{paymentsamount.toFixed(2) |currencypipe}}
                </div>
            </div>
            <ngx-datatable [columnMode]="'force'" [scrollbarH]="true" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50" class="material expandable table" [rows]="totalbalancegrid">
                <ngx-datatable-column prop="paccountname" name="Bank Name"></ngx-datatable-column>
                <ngx-datatable-column prop="popeningbal" name="Opening Balance" [headerClass]="'header-right'" [cellClass]="'cell-right'">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.popeningbal == ' '||row.popeningbal==0"></div>
                        <div *ngIf="row.popeningbal != 0">
                            {{currencysymbol}} {{row.popeningbal | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="pdebitamount" name="Receipts" [headerClass]="'header-right'" [cellClass]="'cell-right'">

                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.pdebitamount == 0"></div>
                        <div *ngIf="row.pdebitamount !== 0">
                            {{currencysymbol}} {{row.pdebitamount.toFixed(2) | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="pcreditamount" name="Payments" [headerClass]="'header-right'" [cellClass]="'cell-right'">

                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.pcreditamount == 0"></div>
                        <div *ngIf="row.pcreditamount !== 0">
                            {{currencysymbol}} {{row.pcreditamount.toFixed(2) | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="pclosingbal" name="Closing Balance" [headerClass]="'header-right'" [cellClass]="'cell-right'">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        <div *ngIf="row.pclosingbal == 0"></div>
                        <div *ngIf="row.pclosingbal != 0">
                            {{currencysymbol}} {{row.pclosingbal | currencypipe}}
                        </div>
                    </ng-template>
                </ngx-datatable-column>
            </ngx-datatable>
        </div>
    </div>

    <!-- row end -->
   
</div>