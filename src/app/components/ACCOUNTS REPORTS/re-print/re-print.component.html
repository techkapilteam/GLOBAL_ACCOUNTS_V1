<div class="screen-container">
  <div class="screen-card">
    <div class="screen-header">
      <h2>Re Print</h2>
    </div>
    <div class="screen-content">
      <form [formGroup]="ReprintRepotForm" autocomplete="off">
        <div class="row">

          <div class="col-md-3 mb-3">
            <label class="required-field">Transaction Type</label>
            <ng-select [items]="lstreporttype" formControlName="TransType" bindLabel="reporttype" bindValue="reporttype"
              placeholder="Select" [searchable]="true" [clearable]="false" appendTo="body"
              (change)="reportchange_Change($event)"
              [ngClass]="{ 'is-invalid': ReprintRepotForm.get('TransType')?.touched && ReprintRepotForm.get('TransType')?.invalid }">
            </ng-select>
            <div class="text-danger mt-1"
              *ngIf="ReprintRepotForm.get('TransType')?.touched && ReprintRepotForm.get('TransType')?.errors?.['required']">
              Transaction Type is required
            </div>
          </div>

          <div class="col-md-3 mb-3" *ngIf="userbranchtxtboxshowhide">
            <label class="required-field">Transaction No.</label>
            <input appUppercase class="form-control" type="text" formControlName="Transno"
              [ngClass]="{ 'is-invalid': ReprintRepotForm.get('Transno')?.touched && ReprintRepotForm.get('Transno')?.invalid }" />
            <div class="text-danger mt-1"
              *ngIf="ReprintRepotForm.get('Transno')?.touched && ReprintRepotForm.get('Transno')?.errors?.['required']">
              Transaction No. is required
            </div>
          </div>

          <div class="col-md-3 mb-3" *ngIf="form15UID">
            <label class="required-field">PAN No.</label>
            <input appUppercase class="form-control" type="text" formControlName="panno"
              [ngClass]="{ 'is-invalid': ReprintRepotForm.get('panno')?.touched && ReprintRepotForm.get('panno')?.invalid }" />
            <div class="text-danger mt-1" *ngIf="ReprintRepotForm.get('panno')?.errors?.['pattern']">
              Invalid PAN format (ABCDE1234F)
            </div>
          </div>

          <div class="col-md-3 mb-3" *ngIf="userbranchngselectshowhide">
            <label class="required-field">CAO</label>
            <ng-select [items]="caolist" formControlName="branch_name" bindLabel="branch_name" bindValue="branch_code"
              placeholder="Select" [searchable]="true" [clearable]="false"
              [ngClass]="{ 'is-invalid': ReprintRepotForm.get('branch_name')?.touched && ReprintRepotForm.get('branch_name')?.invalid }">
            </ng-select>
            <div class="text-danger mt-1"
              *ngIf="ReprintRepotForm.get('branch_name')?.touched && ReprintRepotForm.get('branch_name')?.errors?.['required']">
              Branch selection is required
            </div>
          </div>

          <div class="col-md-3 d-flex align-items-end mb-3">
            <button type="button" class="btn btn-primary w-100" (click)="getduplicateReport()">
              Generate Report
            </button>
          </div>

        </div>
      </form>
    </div>
  </div>

  <div class="card shadow-sm" *ngIf="Showhide">
    <div class="card-body">

      <div class="row mb-3">
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" (keyup)="ReprintdataFilter($event.target.value)" />
            <button class="btn btn-outline-secondary">
              <i class="fa fa-search">Search</i>
            </button>
          </div>
        </div>
      </div>

      <p-table [value]="griddata" [paginator]="true" [rows]="pageCriteria.pageSize"
        [first]="pageCriteria.offset * pageCriteria.pageSize" [totalRecords]="pageCriteria.totalrows"
        responsiveLayout="scroll" styleClass="p-datatable-gridlines">

        <ng-template pTemplate="header">
          <tr>
            <th>T/R Receipt No.</th>
            <th>Receipt Date</th>
            <th>Receipt No.</th>
            <th>Chit No.</th>
            <th class="text-end">Receipt Amount</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-row>
          <tr>
            <td>{{ row.general_receipt_number }}</td>

            <td>
              {{ row.receipt_date ? (row.receipt_date | date:'dd/MM/yyyy') : '--NA--' }}
            </td>

            <td>{{ row.receipt_number }}</td>

            <td>{{ row.ticketno }}</td>

            <td class="text-end">
              {{ currencysymbol }} {{ row.total_received_amount | number:'1.2-2' }}
            </td>
          </tr>
        </ng-template>

      </p-table>

    </div>
  </div>
</div>